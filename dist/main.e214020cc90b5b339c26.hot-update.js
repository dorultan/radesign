exports.id = "main";
exports.modules = {

/***/ "./api/controllers/projectsController.js":
/*!***********************************************!*\
  !*** ./api/controllers/projectsController.js ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("eval(\"__webpack_require__.r(__webpack_exports__);\\n/* harmony import */ var _models_project__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/project */ \\\"./api/models/project.js\\\");\\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! multer */ \\\"multer\\\");\\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(multer__WEBPACK_IMPORTED_MODULE_1__);\\n/* harmony import */ var multer_s3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! multer-s3 */ \\\"multer-s3\\\");\\n/* harmony import */ var multer_s3__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(multer_s3__WEBPACK_IMPORTED_MODULE_2__);\\n/* harmony import */ var aws_sdk__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aws-sdk */ \\\"aws-sdk\\\");\\n/* harmony import */ var aws_sdk__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(aws_sdk__WEBPACK_IMPORTED_MODULE_3__);\\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \\\"fs\\\");\\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\\n\\n\\n\\n\\n\\n\\nvar replaceSpaceFromString = function replaceSpaceFromString(string) {\\n  var str = string.toLowerCase();\\n  while (str.includes(' ')) {\\n    str = str.replace(' ', '-');\\n  }\\n\\n  return str;\\n};\\n\\naws_sdk__WEBPACK_IMPORTED_MODULE_3___default.a.config.update({\\n  accessKeyId: \\\"AKIAJCF6UXSVA3ZA6E3Q\\\",\\n  secretAccessKey: \\\"Ph5m3EuYYgQjgNJvabbvnLacRjRa/Hwb7QABw7WZ\\\",\\n  region: 'eu-west-2'\\n});\\nvar s3 = new aws_sdk__WEBPACK_IMPORTED_MODULE_3___default.a.S3();\\n\\nvar storage = multer_s3__WEBPACK_IMPORTED_MODULE_2___default()({\\n  s3: s3,\\n  bucket: 'radesign',\\n  acl: 'public-read',\\n  key: function key(req, file, cb) {\\n    cb(null, file.originalname);\\n  }\\n});\\n\\nvar upload = multer__WEBPACK_IMPORTED_MODULE_1___default()({ storage: storage }).single('image');\\n\\nvar deleteFiles = function deleteFiles(arr, cb) {\\n  var params = {\\n    Delete: {\\n      Objects: [],\\n      Quiet: false\\n    },\\n    Bucket: 'radesign'\\n  };\\n  arr.forEach(function (fileUrl, idx) {\\n    var key = fileUrl.split('/');\\n    key = key[key.length - 1];\\n    params.Delete.Objects.push({\\n      Key: key\\n    });\\n  });\\n  s3.deleteObjects(params, cb);\\n};\\n\\nvar projectsController = {\\n  get: function get(req, res, next) {\\n\\n    if (req.query.uid) {\\n      _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].findOne({ uid: req.query.uid }).exec(function (err, data) {\\n\\n        if (err) {\\n          return res.status(404).json({ message: \\\"Not found\\\" });\\n        }\\n\\n        return res.status(200).json(data);\\n      });\\n    } else {\\n      next();\\n    }\\n  },\\n  getAll: function getAll(req, res) {\\n\\n    _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].find().exec(function (err, data) {\\n\\n      if (err) {\\n        return res.status(404).json({ message: \\\"Projects not found\\\" });\\n      }\\n\\n      res.status(200).json(data);\\n    });\\n  },\\n  addImage: function addImage(req, res) {\\n    upload(req, res, function (err) {\\n      var file = req.file;\\n\\n      var uid = req.body.uid;\\n\\n      if (err instanceof multer__WEBPACK_IMPORTED_MODULE_1___default.a.MulterError) {\\n        return res.status(400).json({ multerError: err });\\n      }\\n\\n      _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].findOneAndUpdate({ uid: uid }, {\\n        $push: {\\n          uploads: file.location\\n        }\\n      }, {\\n        new: true\\n      }).exec(function (err, data) {\\n        if (err) {\\n          return res.status(400).json({ error: err });\\n        }\\n\\n        return res.status(200).json(data);\\n      });\\n    });\\n  },\\n  removeImage: function removeImage(req, res) {\\n    var uid = req.body.uid;\\n    var path = req.body.path;\\n    _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].findOneAndUpdate({ uid: uid }, {\\n      $pull: {\\n        uploads: path\\n      }\\n    }, {\\n      upsert: true,\\n      new: true\\n    }).exec(function (err, data) {\\n      var key = path.split('/');\\n      key = key[key.length - 1];\\n\\n      if (err) {\\n        return res.status(400).json({ error: err });\\n      }\\n\\n      s3.deleteObject({ Bucket: 'radesign', Key: key }, function (err, success) {\\n        if (err) {\\n          return res.status(400).json({ error: err });\\n        }\\n        return res.status(200).json(data);\\n      });\\n    });\\n  },\\n  create: function create(req, res) {\\n\\n    upload(req, res, function (err) {\\n      var file = req.file;\\n      if (err instanceof multer__WEBPACK_IMPORTED_MODULE_1___default.a.MulterError) {\\n        return res.status(500).json(err);\\n      }\\n\\n      if (file) {\\n        _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].create({\\n          imageUrl: file.location,\\n          description: req.body.description,\\n          name: req.body.name,\\n          uid: replaceSpaceFromString(req.body.name),\\n          tag: req.body.tag,\\n          color: req.body.color\\n        }, function (err, data) {\\n          if (err) {\\n            return res.status(404).json({ message: err.message });\\n          }\\n\\n          return res.status(200).json(data);\\n        });\\n      } else {\\n        res.status(500).json({ message: \\\"Can't upload image.\\\" });\\n      }\\n    });\\n  },\\n  update: function update(req, res) {\\n    var uid = req.body.uid;\\n    var body = req.body;\\n    _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].findOneAndUpdate({ uid: uid }, {\\n      description: body.description,\\n      name: body.name,\\n      tag: req.body.tag,\\n      color: req.body.color,\\n      uid: replaceSpaceFromString(req.body.uid)\\n    }, { new: true }).exec(function (err, data) {\\n      if (err) {\\n        return res.status(404).json({ message: 'The project is not updated.' });\\n      }\\n\\n      res.status(200).json(data);\\n    });\\n  },\\n  updateImage: function updateImage(req, res, next) {\\n\\n    upload(req, res, function (err) {\\n      var file = req.file;\\n      var uid = req.body.uid;\\n      var body = req.body;\\n\\n      if (file) {\\n        _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].findOneAndUpdate({ uid: uid }, {\\n          imageUrl: file.location,\\n          description: body.description,\\n          name: body.name,\\n          tag: body.tag,\\n          color: body.color,\\n          uid: replaceSpaceFromString(body.name)\\n        }, { new: true }).exec(function (err, data) {\\n          var key = body.oldImagePath.split('/');\\n          key = key[key.length - 1];\\n          if (err) {\\n            return res.status(404).json({ message: 'The project is not updated.' });\\n          }\\n\\n          s3.deleteObject({ Bucket: 'radesign', Key: key }, function (err, success) {\\n            if (err) {\\n              return res.status(404).json({ message: \\\"Can't remove image.\\\" });\\n            }\\n\\n            return res.status(200).json(data);\\n          });\\n        });\\n        // Update the project based on project_id received from the body;\\n      } else {\\n        next();\\n      }\\n    });\\n  },\\n  delete: function _delete(req, res) {\\n\\n    _models_project__WEBPACK_IMPORTED_MODULE_0__[\\\"default\\\"].findOneAndRemove({ uid: req.query.uid }).exec(function (err, data) {\\n      var images = [];\\n\\n      if (err) {\\n\\n        return res.status(400).json({ message: \\\"Can't remove the project.\\\" });\\n      }\\n      images.push(data.imageUrl);\\n      images = images.concat(data.uploads);\\n\\n      deleteFiles(images, function (err, success) {\\n        if (err) {\\n          return res.status(405).json({ message: \\\"Can't remove files.\\\", error: err });\\n        }\\n        return res.status(200).json(data);\\n      });\\n    });\\n  }\\n};\\n\\n/* harmony default export */ __webpack_exports__[\\\"default\\\"] = (projectsController);//# sourceURL=[module]\\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcGkvY29udHJvbGxlcnMvcHJvamVjdHNDb250cm9sbGVyLmpzPzE2NTIiXSwibmFtZXMiOlsicmVwbGFjZVNwYWNlRnJvbVN0cmluZyIsInN0cmluZyIsInN0ciIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJyZXBsYWNlIiwiYXdzIiwiY29uZmlnIiwidXBkYXRlIiwiYWNjZXNzS2V5SWQiLCJwcm9jZXNzIiwic2VjcmV0QWNjZXNzS2V5IiwicmVnaW9uIiwiczMiLCJTMyIsInN0b3JhZ2UiLCJtdWx0ZXJTMyIsImJ1Y2tldCIsImFjbCIsImtleSIsInJlcSIsImZpbGUiLCJjYiIsIm9yaWdpbmFsbmFtZSIsInVwbG9hZCIsIm11bHRlciIsInNpbmdsZSIsImRlbGV0ZUZpbGVzIiwiYXJyIiwicGFyYW1zIiwiRGVsZXRlIiwiT2JqZWN0cyIsIlF1aWV0IiwiQnVja2V0IiwiZm9yRWFjaCIsImZpbGVVcmwiLCJpZHgiLCJzcGxpdCIsImxlbmd0aCIsInB1c2giLCJLZXkiLCJkZWxldGVPYmplY3RzIiwicHJvamVjdHNDb250cm9sbGVyIiwiZ2V0IiwicmVzIiwibmV4dCIsInF1ZXJ5IiwidWlkIiwiUHJvamVjdCIsImZpbmRPbmUiLCJleGVjIiwiZXJyIiwiZGF0YSIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZ2V0QWxsIiwiZmluZCIsImFkZEltYWdlIiwiYm9keSIsIk11bHRlckVycm9yIiwibXVsdGVyRXJyb3IiLCJmaW5kT25lQW5kVXBkYXRlIiwiJHB1c2giLCJ1cGxvYWRzIiwibG9jYXRpb24iLCJuZXciLCJlcnJvciIsInJlbW92ZUltYWdlIiwicGF0aCIsIiRwdWxsIiwidXBzZXJ0IiwiZGVsZXRlT2JqZWN0Iiwic3VjY2VzcyIsImNyZWF0ZSIsImltYWdlVXJsIiwiZGVzY3JpcHRpb24iLCJuYW1lIiwidGFnIiwiY29sb3IiLCJ1cGRhdGVJbWFnZSIsIm9sZEltYWdlUGF0aCIsImRlbGV0ZSIsImZpbmRPbmVB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R2pDLEdBQUgsRUFBUTs7QUFFTixlQUFPUCxJQUFJUyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsRUFBQ0MsU0FBUywyQkFBVixFQUFyQixDQUFQO0FBQ0Q7QUFDRDZCLGFBQU83QyxJQUFQLENBQVlhLEtBQUt1QixRQUFqQjtBQUNBUyxlQUFTQSxPQUFPQyxNQUFQLENBQWNqQyxLQUFLWSxPQUFuQixDQUFUOztBQUVBckMsa0JBQVl5RCxNQUFaLEVBQW9CLFVBQUNqQyxHQUFELEVBQU1zQixPQUFOLEVBQWtCO0FBQ3BDLFlBQUd0QixHQUFILEVBQVE7QUFDTixpQkFBT1AsSUFBSVMsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLEVBQUNDLFNBQVMscUJBQVYsRUFBaUNZLE9BQU9oQixHQUF4QyxFQUFyQixDQUFQO0FBQ0Q7QUFDRCxlQUFPUCxJQUFJUyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJGLElBQXJCLENBQVA7QUFDRCxPQUxEO0FBT0QsS0FyQkQ7QUFzQkQ7QUFsT3dCLENBQTNCOztBQXFPZVYsaUZBQWYiLCJmaWxlIjoiLi9hcGkvY29udHJvbGxlcnMvcHJvamVjdHNDb250cm9sbGVyLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb2plY3QgZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnO1xyXG5pbXBvcnQgbXVsdGVyIGZyb20gJ211bHRlcic7XHJcbmltcG9ydCBtdWx0ZXJTMyBmcm9tICdtdWx0ZXItczMnO1xyXG5pbXBvcnQgYXdzIGZyb20gJ2F3cy1zZGsnO1xyXG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xyXG5cclxuY29uc3QgcmVwbGFjZVNwYWNlRnJvbVN0cmluZyA9IChzdHJpbmcpID0+IHtcclxuICBsZXQgc3RyID0gc3RyaW5nLnRvTG93ZXJDYXNlKCk7XHJcbiAgd2hpbGUgKHN0ci5pbmNsdWRlcygnICcpKSB7XHJcbiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKCcgJywgJy0nKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBzdHI7XHJcbn1cclxuXHJcblxyXG5hd3MuY29uZmlnLnVwZGF0ZSh7XHJcbiAgYWNjZXNzS2V5SWQ6IHByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lELFxyXG4gIHNlY3JldEFjY2Vzc0tleTogcHJvY2Vzcy5lbnYuQVdTX1NFQ1JFVF9BQ0NFU1NfS0VZLFxyXG4gIHJlZ2lvbjogJ2V1LXdlc3QtMidcclxufSlcclxuY29uc3QgczMgPSBuZXcgYXdzLlMzKClcclxuXHJcbmNvbnN0IHN0b3JhZ2UgPSBtdWx0ZXJTMyh7XHJcbiAgczM6IHMzLFxyXG4gIGJ1Y2tldDogJ3JhZGVzaWduJyxcclxuICBhY2w6ICdwdWJsaWMtcmVhZCcsXHJcbiAga2V5OiBmdW5jdGlvbihyZXEsIGZpbGUsIGNiKSB7XHJcbiAgICBjYihudWxsLCBmaWxlLm9yaWdpbmFsbmFtZSk7XHJcbiAgfVxyXG59KVxyXG5cclxuY29uc3QgdXBsb2FkID0gbXVsdGVyKHtzdG9yYWdlOiBzdG9yYWdlfSkuc2luZ2xlKCdpbWFnZScpO1xyXG5cclxuXHJcbmNvbnN0IGRlbGV0ZUZpbGVzID0gKGFyciwgY2IpID0+IHtcclxuICBjb25zdCBwYXJhbXMgPSB7XHJcbiAgICBEZWxldGU6IHtcclxuICAgICAgT2JqZWN0czogW1xyXG5cclxuICAgICAgXSxcclxuICAgICAgUXVpZXQ6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgQnVja2V0OiAncmFkZXNpZ24nXHJcbiAgfVxyXG4gIGFyci5mb3JFYWNoKChmaWxlVXJsLCBpZHgpID0+IHtcclxuICAgIGxldCBrZXkgPSBmaWxlVXJsLnNwbGl0KCcvJyk7XHJcbiAgICBrZXkgPSBrZXlba2V5Lmxlbmd0aCAtMV07XHJcbiAgICBwYXJhbXMuRGVsZXRlLk9iamVjdHMucHVzaCh7XHJcbiAgICAgIEtleToga2V5XHJcbiAgICB9KVxyXG4gIH0pXHJcbiAgczMuZGVsZXRlT2JqZWN0cyhwYXJhbXMsIGNiKVxyXG59XHJcblxyXG5jb25zdCBwcm9qZWN0c0NvbnRyb2xsZXIgPSB7XHJcbiAgZ2V0KHJlcSwgcmVzLCBuZXh0KSB7XHJcblxyXG4gICAgaWYocmVxLnF1ZXJ5LnVpZCkge1xyXG4gICAgICBQcm9qZWN0XHJcbiAgICAgIC5maW5kT25lKHt1aWQ6IHJlcS5xdWVyeS51aWR9KVxyXG5cclxuICAgICAgLmV4ZWMoKGVyciwgZGF0YSkgPT4ge1xyXG5cclxuICAgICAgICBpZihlcnIpIHtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7bWVzc2FnZTogXCJOb3QgZm91bmRcIn0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKGRhdGEpO1xyXG4gICAgICB9KVxyXG5cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBuZXh0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICB9LFxyXG5cclxuICBnZXRBbGwocmVxLCByZXMpIHtcclxuXHJcbiAgICBQcm9qZWN0XHJcblxyXG4gICAgLmZpbmQoKVxyXG5cclxuICAgIC5leGVjKChlcnIsIGRhdGEpID0+IHtcclxuXHJcbiAgICAgIGlmKGVycikge1xyXG4gICAgICAgIHJldHVybiAgcmVzLnN0YXR1cyg0MDQpLmpzb24oe21lc3NhZ2U6IFwiUHJvamVjdHMgbm90IGZvdW5kXCJ9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihkYXRhKTtcclxuICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgYWRkSW1hZ2UocmVxLCByZXMpIHtcclxuICAgIHVwbG9hZChyZXEsIHJlcywgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIGNvbnN0IGZpbGUgPSByZXEuZmlsZTtcclxuXHJcbiAgICAgIGNvbnN0IHVpZCA9IHJlcS5ib2R5LnVpZDtcclxuXHJcbiAgICAgIGlmKGVyciBpbnN0YW5jZW9mIG11bHRlci5NdWx0ZXJFcnJvcikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7bXVsdGVyRXJyb3I6IGVycn0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBQcm9qZWN0XHJcblxyXG4gICAgICAuZmluZE9uZUFuZFVwZGF0ZSh7dWlkOiB1aWR9LFxyXG4gICAgICB7XHJcbiAgICAgICAgJHB1c2g6IHtcclxuICAgICAgICAgIHVwbG9hZHM6IGZpbGUubG9jYXRpb25cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBuZXc6IHRydWVcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5leGVjKChlcnIsIGRhdGEpID0+IHtcclxuICAgICAgICBpZihlcnIpIHtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7ZXJyb3I6IGVycn0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oZGF0YSk7XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIHJlbW92ZUltYWdlKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCB1aWQgPSByZXEuYm9keS51aWQ7XHJcbiAgICBjb25zdCBwYXRoID0gcmVxLmJvZHkucGF0aDtcclxuICAgIFByb2plY3RcclxuXHJcbiAgICAuZmluZE9uZUFuZFVwZGF0ZSh7dWlkOiB1aWR9LFxyXG4gICAge1xyXG4gICAgICAkcHVsbDoge1xyXG4gICAgICAgIHVwbG9hZHM6IHBhdGhcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdXBzZXJ0OiB0cnVlLFxyXG4gICAgICBuZXc6IHRydWVcclxuICAgIH0pXHJcblxyXG4gICAgLmV4ZWMoKGVyciwgZGF0YSkgPT4ge1xyXG4gICAgICBsZXQga2V5ID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICBrZXkgPSBrZXlba2V5Lmxlbmd0aCAtMV07XHJcblxyXG4gICAgICBpZihlcnIpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe2Vycm9yOiBlcnJ9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICBzMy5kZWxldGVPYmplY3Qoe0J1Y2tldDogJ3JhZGVzaWduJywgS2V5OiBrZXl9LCAoZXJyLCBzdWNjZXNzKSA9PiB7XHJcbiAgICAgICAgaWYoZXJyKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe2Vycm9yOiBlcnJ9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oZGF0YSk7XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZShyZXEsIHJlcykge1xyXG5cclxuICAgIHVwbG9hZChyZXEsIHJlcywgZnVuY3Rpb24oZXJyKSB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSByZXEuZmlsZTtcclxuXHRcdFx0aWYoZXJyIGluc3RhbmNlb2YgbXVsdGVyLk11bHRlckVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKGVycik7XHJcblx0XHRcdH1cclxuXHJcbiAgICAgIGlmKGZpbGUpIHtcclxuICAgICAgICBQcm9qZWN0XHJcblxyXG4gICAgICAgIC5jcmVhdGUoe1xyXG4gICAgICAgICAgaW1hZ2VVcmw6IGZpbGUubG9jYXRpb24sXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogcmVxLmJvZHkuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBuYW1lOiByZXEuYm9keS5uYW1lLFxyXG4gICAgICAgICAgdWlkOiByZXBsYWNlU3BhY2VGcm9tU3RyaW5nKHJlcS5ib2R5Lm5hbWUpLFxyXG4gICAgICAgICAgdGFnOiByZXEuYm9keS50YWcsXHJcbiAgICAgICAgICBjb2xvcjogcmVxLmJvZHkuY29sb3JcclxuICAgICAgICB9LCAoZXJyLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICBpZihlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHttZXNzYWdlOiBlcnIubWVzc2FnZX0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6IFwiQ2FuJ3QgdXBsb2FkIGltYWdlLlwifSlcclxuICAgICAgfVxyXG5cclxuICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCB1aWQgPSByZXEuYm9keS51aWQ7XHJcbiAgICBjb25zdCBib2R5ID0gcmVxLmJvZHk7XHJcbiAgICBQcm9qZWN0XHJcbiAgICAuZmluZE9uZUFuZFVwZGF0ZSh7dWlkOiB1aWR9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZGVzY3JpcHRpb246IGJvZHkuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgbmFtZTogYm9keS5uYW1lLFxyXG4gICAgICAgIHRhZzogcmVxLmJvZHkudGFnLFxyXG4gICAgICAgIGNvbG9yOiByZXEuYm9keS5jb2xvcixcclxuICAgICAgICB1aWQ6IHJlcGxhY2VTcGFjZUZyb21TdHJpbmcocmVxLmJvZHkudWlkKVxyXG4gICAgICB9LCB7bmV3OiB0cnVlfSlcclxuXHJcbiAgICAuZXhlYygoZXJyLCBkYXRhKSA9PiB7XHJcbiAgICAgIGlmKGVycikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7bWVzc2FnZTogJ1RoZSBwcm9qZWN0IGlzIG5vdCB1cGRhdGVkLid9KVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihkYXRhKVxyXG4gICAgfSlcclxuICB9LFxyXG5cclxuICB1cGRhdGVJbWFnZShyZXEsIHJlcywgbmV4dCkge1xyXG5cclxuICAgIHVwbG9hZChyZXEsIHJlcywgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgIGNvbnN0IGZpbGUgPSByZXEuZmlsZTtcclxuICAgICAgY29uc3QgdWlkID0gcmVxLmJvZHkudWlkO1xyXG4gICAgICBjb25zdCBib2R5ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgICBpZihmaWxlKSB7XHJcbiAgICAgICAgUHJvamVjdFxyXG4gICAgICAgIC5maW5kT25lQW5kVXBkYXRlKHt1aWQ6IHVpZH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGltYWdlVXJsOiBmaWxlLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYm9keS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgbmFtZTogYm9keS5uYW1lLFxyXG4gICAgICAgICAgICB0YWc6IGJvZHkudGFnLFxyXG4gICAgICAgICAgICBjb2xvcjogYm9keS5jb2xvcixcclxuICAgICAgICAgICAgdWlkOiByZXBsYWNlU3BhY2VGcm9tU3RyaW5nKGJvZHkubmFtZSlcclxuICAgICAgICAgIH0sIHtuZXc6IHRydWV9KVxyXG5cclxuICAgICAgICAuZXhlYygoZXJyLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICBsZXQga2V5ID0gYm9keS5vbGRJbWFnZVBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgIGtleSA9IGtleVtrZXkubGVuZ3RoIC0xXTtcclxuICAgICAgICAgIGlmKGVycikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe21lc3NhZ2U6ICdUaGUgcHJvamVjdCBpcyBub3QgdXBkYXRlZC4nfSlcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBzMy5kZWxldGVPYmplY3Qoe0J1Y2tldDogJ3JhZGVzaWduJywgS2V5OiBrZXl9LCAoZXJyLCBzdWNjZXNzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmKGVycikge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7bWVzc2FnZTogXCJDYW4ndCByZW1vdmUgaW1hZ2UuXCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oZGF0YSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBwcm9qZWN0IGJhc2VkIG9uIHByb2plY3RfaWQgcmVjZWl2ZWQgZnJvbSB0aGUgYm9keTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgbmV4dCgpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgZGVsZXRlKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgUHJvamVjdFxyXG5cclxuICAgIC5maW5kT25lQW5kUmVtb3ZlKHt1aWQ6IHJlcS5xdWVyeS51aWR9KVxyXG5cclxuICAgIC5leGVjKChlcnIsIGRhdGEpID0+IHtcclxuICAgICAgbGV0IGltYWdlcyA9IFtdO1xyXG5cclxuICAgICAgaWYoZXJyKSB7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7bWVzc2FnZTogXCJDYW4ndCByZW1vdmUgdGhlIHByb2plY3QuXCJ9KTtcclxuICAgICAgfVxyXG4gICAgICBpbWFnZXMucHVzaChkYXRhLmltYWdlVXJsKTtcclxuICAgICAgaW1hZ2VzID0gaW1hZ2VzLmNvbmNhdChkYXRhLnVwbG9hZHMpO1xyXG5cclxuICAgICAgZGVsZXRlRmlsZXMoaW1hZ2VzLCAoZXJyLCBzdWNjZXNzKSA9PiB7XHJcbiAgICAgICAgaWYoZXJyKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe21lc3NhZ2U6IFwiQ2FuJ3QgcmVtb3ZlIGZpbGVzLlwiLCBlcnJvcjogZXJyfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKGRhdGEpO1xyXG4gICAgICB9KVxyXG5cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwcm9qZWN0c0NvbnRyb2xsZXI7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\\n//# sourceURL=webpack-internal:///./api/controllers/projectsController.js\\n\");\n\n//# sourceURL=webpack:///./api/controllers/projectsController.js?");

/***/ })

};